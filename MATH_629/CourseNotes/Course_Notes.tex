\documentclass{article}
\usepackage{amsmath, amsfonts}
\usepackage{enumerate}
\usepackage{subfig}
\input{notes_macros}
\setlength\parindent{0pt}
\setlength{\parskip}{\baselineskip}%
\begin{document}
\CPT{1}

\idf{1.1} \textbf{Survival analysis} is a collection of statistical procedures for data analysis for which the outcome variable of interest is time, $T$, until an event occurs.

\ir{1.1}
\bn
\im $T$ is a random variable with positive support. Examples are time until death, time until machine breaks, length of road travelled until have a flat tire, etc. We will use the phrases ``time until event'' and ``survival time'' interchangeably.
\im There are extensions and variations of survival analysis including \textbf{recurrent events} and \textbf{competing risks}.
\im Example of recurrent events - multiple hospitalizations. Example of competing risks - death on dialysis and receiving a kidney transplant.
\en

\idf{1.2} \textbf{Censoring} is when you have some, but not all, information about the time until event for some or all of your observations. There are three types of censoring.

We will only deal with right censored data in this course. This is the most common type of censoring.


\ir{1.2} We use the following notation
\bn
\item $T$ is the population random variable that represents time until event.
\item $t$ is the observed value of $T$.
\item $d$ is 0 or 1. If $d=0$ there is censoring and if $d=1$ an event (failure) occurred. $\delta$ is often used instead of $d$.
\en

\idf{1.3} The \textbf{survival function} gives the probability that the event will occur after a time $t$. That is,

\[
S(t) = P(T>t) \text{ for } t \in \mathbb{R}.
\]

Note: 1) The survival function always tends to 1 as t tends to infinity, i.e.,
\[
\lim_{t\rightarrow\infty} S(t) = 1
\]
and 2) for positive random variable $T$ we have $S(t) = 0$ for $t \le 0$.

\NTS Draw a smooth survival curve and draw a step function which is often used to estimate one (see page 10).

\idf{1.4} The \textbf{hazard function} is the instantaneous rate of change (i.e., the derivative) of the probability that the event will occur given that it has not occurred up to that time.
\[
h(t) = \lim_{\Delta \rightarrow 0} \frac{P(t \le T < t + \Delta | T \ge t)}{\Delta t}
\]
Note: 1) The hazard function is a rate not a probability, 2) the hazard can be any number from 0 to infinity, i.e, $0\ge h(t) \ge infty$, 3) the hazard depends on the unit of measurement of time. For example, all other things being equal, if time is measured in seconds as opposed to minutes then the hazard is increased by a factor of 60.

\ith{1.1} The hazard function and the survival function of a distribution have the following relationship

\[ S(t) = \exp\left[-\int_0^t h(u) du\right] \text{ and } h(t) = -\frac{d S(t)/dt}{S(t)}
\]
Proof:
\begin{align*} h(t) & = \lim_{\Delta \rightarrow 0} \frac{P(t \le T \le t + \Delta)} {P(T \ge t) \Delta t} \\
& = \frac{1}{S(t)} \lim_{\Delta \rightarrow 0} \frac{P(t \le T < t + \Delta)} {\Delta t} \\
& = \frac{(d/dt)F(t)}{S(t)} = -\frac{(d/dt)S(t)}{S(t)}. 
\end{align*}
Now, 
\begin{align*}
\exp\left[-\int_0^t h(u) du\right] & = \exp\left[-\int_0^t \left(-\frac{dS(u)/du}{S(u)} \right)du\right] \\
&= \exp\left[\ln (S(u)) |_0^t \right] = \exp\left[\ln(S(t)) - \ln(S(0))\right] \\
& = \exp\left[\ln(S(t))\right] = S(t).  
\end{align*} 

\ir{1.2} The first way of representing the data is how we will store our data in a data frame in R. The second way is a ``survival object'' that we create in R from the data frame. From the third way we will be able to estimate survival curves from each of our groups (RX=0 and RX=1). 
\begin{enumerate}[ ]
\item The leftmost column $(t_{(f)})$ gives all of the times at which the event occurs for $f=1,\ldots,n$ plus $t_0$ at the start of the study. 
\item The second column ($m_f$) gives the number of events that occur at each of the times. 
\item The third column ($q_f$) gives the number of observations that were censored in time $[t_f,t_{f-1})$ for $f=2,\ldots,n$. 
\item The last column $R(t_f)$ gives the number ``at risk'' at each time. For example, at time $t_{(1)}=6$, $m_{1}=3$ had the event, $q_{1}=1$ was censored in $[t_{(1)}=6, t_{(2)}=7)$ and
    \[
    R(2)=R(1)-m_{(1)}-q_{(1)}=21-3-1=17
    \]
     were ``at risk'' at time $t_{(2)}$.
\end{enumerate} 
This way of presenting data, helps us estimate probabilities, at each time $t_{f}$ that a subject will ``survive'' beyond time $t_{(f)}$ (i.e. not have the event) have the event given that they have not have ``survived'' up until, but not including, time $t_{f}$. For example, at $t_{(2)}$ we estimate this probability as
\[ \dfrac{R(2)-m_2}{R{(2)}} = \dfrac{17-1}{17} = \dfrac{16}{17}
\]
This will allow us in chapter 2 to estimate overall survival probabilities at times $t_{(f)}, f=1,\ldots,n$ and thus estimate survival curves as step functions. 

\CPT{2}

\CPT{3}

\ith{3.1} Let $LR_F$ be the value of the log-likelihood for a fitted Cox-Proportional Hazard model
\[ h(t;X) = h_0(t) \exp(\sum_i^p \hat{B}_iX_i) \].
Let $LR_R$ be the value of the log-likelihood for a fitted Cox-Proportional Hazard model
\[ h(t;X) = h_0(t) \exp(\sum_i^q \hat{B}_iX_i) \]
where $q<p$.
Then for a ``large sample'' we have the following approximate distribution
\[
-2(LR_R - LR_F) \sim \chi^2(p-q)
\]


\end{document} 